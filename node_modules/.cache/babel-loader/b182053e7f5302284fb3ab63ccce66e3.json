{"ast":null,"code":"var _jsxFileName = \"E:\\\\React\\\\workspace\\\\order-ticket\\\\src\\\\pages\\\\Dev\\\\Trains\\\\Updata\\\\index.jsx\";\nimport React, { Component } from 'react';\nimport { Input, Card, Form, Button, Col, Row, Space, Select, TimePicker, message } from 'antd';\nimport moment from 'moment';\nimport SiteInfo from '../SiteInfo';\nimport CarriageInfo from '../CarriageInfo';\nimport MyNavLink from '../../../../components/MyNavLink';\nimport { addTrain, getTrainInfo } from '../../../../api/dev/train';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  Option\n} = Select;\nconst format = 'HH:mm';\nexport default class TrainUpdate extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      siteList: [],\n      carriageList: [],\n      site: {},\n      isUpdata: 0,\n      trainChange: {}\n    };\n\n    this.handleIsUpdata = (changedValues, allValues) => {\n      console.log(changedValues, allValues);\n      const startTime = moment(allValues.startTime).format('HH:mm');\n      const trainChange = { ...allValues,\n        startTime\n      };\n      console.log(trainChange);\n      this.setState({\n        isUpdata: 1,\n        trainChange\n      });\n    };\n\n    this.updataTrain = async values => {\n      const {\n        siteList,\n        carriageList\n      } = this.state;\n      const startTime = moment(values.startTime).format('HH:mm');\n      const train = { ...values,\n        startTime,\n        siteList,\n        carriageList\n      };\n      const result = await addTrain(train);\n\n      if (result.code === 1) {\n        message.success('添加成功');\n        this.props.history.goBack();\n      } else {\n        message.error(result.msg);\n      }\n    };\n\n    this.addSite = site => {\n      const {\n        siteList\n      } = this.state;\n      const newSite = [...siteList, site];\n      this.setState({\n        siteList: newSite\n      });\n    };\n\n    this.addCarriage = carriage => {\n      const {\n        carriageList\n      } = this.state;\n      const newCarriage = [...carriageList, carriage];\n      this.setState({\n        carriageList: newCarriage\n      });\n    };\n  }\n\n  async componentWillMount() {\n    const {\n      id\n    } = this.props.match.params;\n    const result = await getTrainInfo(id);\n\n    if (result.code === 1) {\n      this.setState({\n        siteList: result.data.siteList,\n        carriageList: result.data.carriageList,\n        site: result.data.baseInfo\n      });\n    } else {\n      message.error(result.msg);\n    }\n  }\n\n  render() {\n    const {\n      siteList,\n      carriageList,\n      site\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          title: /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              fontSize: '30px'\n            },\n            children: \"\\u7F16\\u8F91\\u8F66\\u6B21\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 32\n          }, this),\n          children: Object.keys(site).length ? /*#__PURE__*/_jsxDEV(Form, {\n            layout: \"vertical\",\n            onFinish: this.updataTrain,\n            onValuesChange: this.handleIsUpdata,\n            children: [/*#__PURE__*/_jsxDEV(Row, {\n              gutter: 16,\n              children: [/*#__PURE__*/_jsxDEV(Col, {\n                span: 12,\n                children: /*#__PURE__*/_jsxDEV(Form.Item, {\n                  name: \"trainNumber\",\n                  label: \"\\u8F66\\u6B21\",\n                  rules: [{\n                    required: true,\n                    message: '请输入车次'\n                  }],\n                  required: \"true\",\n                  initialValue: site.trainNumber,\n                  children: /*#__PURE__*/_jsxDEV(Input, {\n                    placeholder: \"\\u8BF7\\u8F93\\u5165\\u8F66\\u6B21\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 97,\n                    columnNumber: 49\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 90,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 89,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(Col, {\n                span: 12,\n                children: /*#__PURE__*/_jsxDEV(Form.Item, {\n                  name: \"isReturn\",\n                  label: \"\\u8FD4\\u7A0B\\u8F66\",\n                  rules: [{\n                    required: true,\n                    message: '请选择是否返程'\n                  }],\n                  required: \"true\",\n                  initialValue: site.isReturn,\n                  children: /*#__PURE__*/_jsxDEV(Select, {\n                    placeholder: \"\\u662F\\u5426\\u8FD4\\u7A0B\",\n                    children: [/*#__PURE__*/_jsxDEV(Option, {\n                      value: 1,\n                      children: \"\\u662F\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 109,\n                      columnNumber: 53\n                    }, this), /*#__PURE__*/_jsxDEV(Option, {\n                      value: 0,\n                      children: \"\\u5426\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 110,\n                      columnNumber: 53\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 108,\n                    columnNumber: 49\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 101,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 100,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 88,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(Row, {\n              gutter: 16,\n              children: [/*#__PURE__*/_jsxDEV(Col, {\n                span: 12,\n                children: /*#__PURE__*/_jsxDEV(Form.Item, {\n                  name: \"type\",\n                  label: \"\\u7C7B\\u522B\",\n                  rules: [{\n                    required: true,\n                    message: '请选择类别'\n                  }],\n                  required: \"true\",\n                  initialValue: site.type,\n                  children: /*#__PURE__*/_jsxDEV(Select, {\n                    placeholder: \"\\u7C7B\\u522B\",\n                    children: [/*#__PURE__*/_jsxDEV(Option, {\n                      value: 1,\n                      children: \"\\u52A8\\u8F66\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 125,\n                      columnNumber: 53\n                    }, this), /*#__PURE__*/_jsxDEV(Option, {\n                      value: 2,\n                      children: \"\\u9AD8\\u94C1\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 126,\n                      columnNumber: 53\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 124,\n                    columnNumber: 49\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 117,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 116,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(Col, {\n                span: 12,\n                children: /*#__PURE__*/_jsxDEV(Form.Item, {\n                  name: \"startTime\",\n                  label: \"\\u53D1\\u8F66\\u65F6\\u95F4\",\n                  rules: [{\n                    required: true,\n                    message: '请选择发车时间'\n                  }],\n                  required: \"true\",\n                  initialValue: moment(site.startTime, format),\n                  children: /*#__PURE__*/_jsxDEV(TimePicker, {\n                    format: format\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 138,\n                    columnNumber: 49\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 131,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 130,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(Row, {\n              gutter: 16,\n              children: /*#__PURE__*/_jsxDEV(Col, {\n                span: 12,\n                children: /*#__PURE__*/_jsxDEV(Form.Item, {\n                  name: \"trainCount\",\n                  label: \"\\u73ED\\u8F66\\u6570\\u91CF\",\n                  rules: [{\n                    required: true,\n                    message: '请输入班车数量'\n                  }],\n                  initialValue: site.shift,\n                  children: /*#__PURE__*/_jsxDEV(Input, {\n                    placeholder: \"\\u8BF7\\u8F93\\u5165\\u73ED\\u8F66\\u6570\\u91CF\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 150,\n                    columnNumber: 49\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 144,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 143,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 142,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(Row, {\n              gutter: 16,\n              children: /*#__PURE__*/_jsxDEV(Col, {\n                span: 12,\n                children: /*#__PURE__*/_jsxDEV(Form.Item, {\n                  rules: [{\n                    required: true,\n                    message: '请输入站点信息'\n                  }],\n                  children: /*#__PURE__*/_jsxDEV(SiteInfo, {\n                    addSite: this.addSite,\n                    siteList: siteList\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 160,\n                    columnNumber: 49\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 156,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(Row, {\n              gutter: 16,\n              children: /*#__PURE__*/_jsxDEV(Col, {\n                span: 20,\n                children: /*#__PURE__*/_jsxDEV(Form.Item, {\n                  rules: [{\n                    required: true,\n                    message: '请输入车厢信息'\n                  }],\n                  children: /*#__PURE__*/_jsxDEV(CarriageInfo, {\n                    addCarriage: this.addCarriage,\n                    carriageList: carriageList\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 169,\n                    columnNumber: 49\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 166,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                textAlign: 'right',\n                marginTop: '50px'\n              },\n              children: /*#__PURE__*/_jsxDEV(Space, {\n                size: \"large\",\n                children: [/*#__PURE__*/_jsxDEV(MyNavLink, {\n                  to: \"/dev/trains\",\n                  children: /*#__PURE__*/_jsxDEV(Button, {\n                    style: {\n                      marginRight: 8\n                    },\n                    children: \"\\u53D6\\u6D88\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 181,\n                    columnNumber: 49\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 180,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(Button, {\n                  type: \"primary\",\n                  htmlType: \"submit\",\n                  children: \"\\u786E\\u8BA4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 185,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 179,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 33\n          }, this) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["E:/React/workspace/order-ticket/src/pages/Dev/Trains/Updata/index.jsx"],"names":["React","Component","Input","Card","Form","Button","Col","Row","Space","Select","TimePicker","message","moment","SiteInfo","CarriageInfo","MyNavLink","addTrain","getTrainInfo","Option","format","TrainUpdate","state","siteList","carriageList","site","isUpdata","trainChange","handleIsUpdata","changedValues","allValues","console","log","startTime","setState","updataTrain","values","train","result","code","success","props","history","goBack","error","msg","addSite","newSite","addCarriage","carriage","newCarriage","componentWillMount","id","match","params","data","baseInfo","render","fontSize","Object","keys","length","required","trainNumber","isReturn","type","shift","textAlign","marginTop","marginRight"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport {\r\n    Input, Card,\r\n    Form, Button, Col, Row, Space, Select, TimePicker, message\r\n} from 'antd';\r\nimport moment from 'moment'\r\nimport SiteInfo from '../SiteInfo';\r\nimport CarriageInfo from '../CarriageInfo'\r\nimport MyNavLink from '../../../../components/MyNavLink'\r\nimport { addTrain, getTrainInfo } from '../../../../api/dev/train';\r\n\r\nconst { Option } = Select\r\nconst format = 'HH:mm'\r\nexport default class TrainUpdate extends Component {\r\n\r\n    state = {\r\n        siteList: [],\r\n        carriageList: [],\r\n        site: {},\r\n        isUpdata: 0,\r\n        trainChange: {}\r\n    }\r\n\r\n    // 判断是否修改过表单\r\n    handleIsUpdata = (changedValues, allValues) => {\r\n        console.log(changedValues, allValues)\r\n        const startTime = moment(allValues.startTime).format('HH:mm')\r\n        const trainChange = { ...allValues, startTime }\r\n        console.log(trainChange)\r\n        this.setState({ isUpdata: 1, trainChange })\r\n    }\r\n\r\n    // 添加车次\r\n    updataTrain = async (values) => {\r\n        const { siteList, carriageList } = this.state\r\n        const startTime = moment(values.startTime).format('HH:mm')\r\n        const train = { ...values, startTime, siteList, carriageList }\r\n        const result = await addTrain(train)\r\n        if (result.code === 1) {\r\n            message.success('添加成功')\r\n            this.props.history.goBack()\r\n        } else {\r\n            message.error(result.msg)\r\n        }\r\n    }\r\n\r\n    addSite = (site) => {\r\n        const { siteList } = this.state\r\n        const newSite = [...siteList, site]\r\n        this.setState({ siteList: newSite })\r\n    }\r\n\r\n    addCarriage = (carriage) => {\r\n        const { carriageList } = this.state\r\n        const newCarriage = [...carriageList, carriage]\r\n        this.setState({ carriageList: newCarriage })\r\n    }\r\n\r\n    async componentWillMount() {\r\n        const { id } = this.props.match.params\r\n        const result = await getTrainInfo(id)\r\n        if (result.code === 1) {\r\n            this.setState({\r\n                siteList: result.data.siteList,\r\n                carriageList: result.data.carriageList,\r\n                site: result.data.baseInfo,\r\n            })\r\n        } else {\r\n            message.error(result.msg)\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const { siteList, carriageList, site } = this.state\r\n        return (\r\n            <div>\r\n                <div>\r\n                    <Card\r\n                        title={<span style={{ fontSize: '30px' }}>编辑车次</span>}\r\n                    >\r\n                        {\r\n                            Object.keys(site).length ?\r\n                                <Form\r\n                                    layout=\"vertical\"\r\n                                    onFinish={this.updataTrain}\r\n                                    onValuesChange={this.handleIsUpdata}\r\n                                >\r\n                                    <Row gutter={16}>\r\n                                        <Col span={12}>\r\n                                            <Form.Item\r\n                                                name=\"trainNumber\"\r\n                                                label=\"车次\"\r\n                                                rules={[{ required: true, message: '请输入车次' }]}\r\n                                                required=\"true\"\r\n                                                initialValue={site.trainNumber}\r\n                                            >\r\n                                                <Input placeholder=\"请输入车次\" />\r\n                                            </Form.Item>\r\n                                        </Col>\r\n                                        <Col span={12}>\r\n                                            <Form.Item\r\n                                                name=\"isReturn\"\r\n                                                label=\"返程车\"\r\n                                                rules={[{ required: true, message: '请选择是否返程' }]}\r\n                                                required=\"true\"\r\n                                                initialValue={site.isReturn}\r\n                                            >\r\n                                                <Select placeholder=\"是否返程\" >\r\n                                                    <Option value={1}>是</Option>\r\n                                                    <Option value={0}>否</Option>\r\n                                                </Select>\r\n                                            </Form.Item>\r\n                                        </Col>\r\n                                    </Row>\r\n                                    <Row gutter={16}>\r\n                                        <Col span={12}>\r\n                                            <Form.Item\r\n                                                name=\"type\"\r\n                                                label=\"类别\"\r\n                                                rules={[{ required: true, message: '请选择类别' }]}\r\n                                                required=\"true\"\r\n                                                initialValue={site.type}\r\n                                            >\r\n                                                <Select placeholder=\"类别\">\r\n                                                    <Option value={1}>动车</Option>\r\n                                                    <Option value={2}>高铁</Option>\r\n                                                </Select>\r\n                                            </Form.Item>\r\n                                        </Col>\r\n                                        <Col span={12}>\r\n                                            <Form.Item\r\n                                                name=\"startTime\"\r\n                                                label=\"发车时间\"\r\n                                                rules={[{ required: true, message: '请选择发车时间' }]}\r\n                                                required=\"true\"\r\n                                                initialValue={moment(site.startTime, format)}\r\n                                            >\r\n                                                <TimePicker format={format} />\r\n                                            </Form.Item>\r\n                                        </Col>\r\n                                    </Row>\r\n                                    <Row gutter={16}>\r\n                                        <Col span={12}>\r\n                                            <Form.Item\r\n                                                name=\"trainCount\"\r\n                                                label=\"班车数量\"\r\n                                                rules={[{ required: true, message: '请输入班车数量' }]}\r\n                                                initialValue={site.shift}\r\n                                            >\r\n                                                <Input placeholder=\"请输入班车数量\" />\r\n                                            </Form.Item>\r\n                                        </Col>\r\n                                    </Row>\r\n                                    <Row gutter={16}>\r\n                                        <Col span={12}>\r\n                                            <Form.Item\r\n                                                rules={[{ required: true, message: '请输入站点信息' }]}\r\n\r\n                                            >\r\n                                                <SiteInfo addSite={this.addSite} siteList={siteList} />\r\n                                            </Form.Item>\r\n                                        </Col>\r\n                                    </Row>\r\n                                    <Row gutter={16}>\r\n                                        <Col span={20}>\r\n                                            <Form.Item\r\n                                                rules={[{ required: true, message: '请输入车厢信息' }]}\r\n                                            >\r\n                                                <CarriageInfo addCarriage={this.addCarriage} carriageList={carriageList} />\r\n                                            </Form.Item>\r\n                                        </Col>\r\n                                    </Row>\r\n                                    <div\r\n                                        style={{\r\n                                            textAlign: 'right',\r\n                                            marginTop: '50px'\r\n                                        }}\r\n                                    >\r\n                                        <Space size=\"large\">\r\n                                            <MyNavLink to=\"/dev/trains\">\r\n                                                <Button style={{ marginRight: 8 }}>\r\n                                                    取消\r\n                                                </Button>\r\n                                            </MyNavLink>\r\n                                            <Button type=\"primary\" htmlType=\"submit\">\r\n                                                确认\r\n                                            </Button>\r\n                                        </Space>\r\n\r\n                                    </div>\r\n                                </Form> : null\r\n                        }\r\n                    </Card>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}