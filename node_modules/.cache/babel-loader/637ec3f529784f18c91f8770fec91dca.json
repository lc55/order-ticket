{"ast":null,"code":"var _jsxFileName = \"E:\\\\React\\\\workspace\\\\order-ticket\\\\src\\\\pages\\\\Dev\\\\Trains\\\\SiteInfo\\\\index.jsx\";\nimport React, { Component } from 'react';\nimport { Card, Button, Table, Modal, Space, Form, Select, Popconfirm, Divider, message, Input } from 'antd';\nimport { PlusOutlined } from '@ant-design/icons';\nimport LinkButton from '../../../../components/LinkButton';\nimport { getSiteList } from '../../../../api/dev/train';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  Option\n} = Select;\nexport default class SiteInfo extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      showStatus: 0,\n      number: 1,\n      dataSource: [],\n      sites: [],\n      siteId: 0,\n      addUpdata: 0\n    };\n\n    this.addSite = async () => {\n      // 调用接口拿数据\n      const result = await getSiteList();\n\n      if (result.code === 1) {\n        this.setState({\n          showStatus: 1,\n          sites: result.data\n        });\n      } else {\n        message.error(result.msg);\n      }\n    };\n\n    this.handleCancel = () => {\n      this.setState({\n        showStatus: 0\n      });\n    };\n\n    this.onFinish = values => {\n      const {\n        dataSource,\n        number,\n        siteId\n      } = this.state;\n      const v = {\n        number,\n        ...values\n      };\n      v.number = number;\n      v.siteId = siteId;\n      v.key = siteId;\n      const newData = [...dataSource, v];\n      const {\n        useTime\n      } = values;\n      const site = {\n        siteId,\n        useTime,\n        number\n      };\n      this.props.addSite(site);\n      this.setState({\n        showStatus: 0,\n        dataSource: newData,\n        number: number + 1\n      });\n    };\n\n    this.handleDelete = number => {\n      const dataSource = [...this.state.dataSource];\n      const newDataSource = dataSource.filter(item => {\n        if (item.number !== number) {\n          if (item.number > number) {\n            --item.number;\n          }\n\n          return item;\n        }\n      });\n      this.props.deleteSite(number);\n      if (newDataSource.length === 0) this.setState({\n        count: 1\n      });\n      this.setState({\n        dataSource: newDataSource\n      });\n    };\n\n    this.handleSelect = (_, value) => {\n      this.setState({\n        siteId: value.key\n      });\n    };\n  }\n\n  componentDidMount() {\n    let {\n      siteList\n    } = this.props;\n    console.log(!siteList);\n    let {\n      number\n    } = this.state;\n    const newList = siteList.map((item, _) => {\n      item.number = number;\n      number++;\n      item.useTime = item.timeConsume;\n      return item;\n    });\n    this.setState({\n      dataSource: newList,\n      number\n    });\n  }\n\n  render() {\n    let {\n      showStatus,\n      dataSource,\n      sites\n    } = this.state;\n    const columns = [{\n      title: '序号',\n      dataIndex: 'number',\n      key: '1',\n      align: 'center'\n    }, {\n      title: '到达城市',\n      dataIndex: 'siteName',\n      key: '2',\n      align: 'center'\n    }, {\n      title: '用时（分）',\n      dataIndex: 'useTime',\n      key: '3',\n      align: 'center'\n    }, {\n      title: '操作',\n      key: '4',\n      align: 'center',\n      render: (_, record) => this.state.dataSource.length >= 1 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(Popconfirm, {\n          title: \"\\u786E\\u5B9A\\u5220\\u9664\\u5417\",\n          onConfirm: () => this.handleDelete(record.number),\n          children: /*#__PURE__*/_jsxDEV(LinkButton, {\n            children: \"\\u5220\\u9664\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 29\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 25\n      }, this) : null\n    }];\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          title: /*#__PURE__*/_jsxDEV(Divider, {\n            orientation: \"left\",\n            plain: true,\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              shape: \"round\",\n              children: \"\\u7AD9\\u70B9\\u4FE1\\u606F\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 32\n          }, this),\n          size: \"small\",\n          extra: /*#__PURE__*/_jsxDEV(Button, {\n            onClick: this.addSite,\n            icon: /*#__PURE__*/_jsxDEV(PlusOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 132,\n              columnNumber: 69\n            }, this),\n            type: \"primary\",\n            style: {\n              marginRight: '20px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 32\n          }, this),\n          children: /*#__PURE__*/_jsxDEV(Table, {\n            columns: columns,\n            dataSource: dataSource,\n            bordered: true,\n            rowKey: \"number\",\n            pagination: false\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(Modal, {\n          title: \"\\u6DFB\\u52A0\\u8F66\\u53A2\\u4FE1\\u606F\",\n          visible: showStatus === 1,\n          onOk: this.handleAdd,\n          onCancel: this.handleCancel,\n          footer: [],\n          width: \"800px\",\n          style: {\n            top: 100\n          },\n          destroyOnClose: \"true\",\n          children: /*#__PURE__*/_jsxDEV(Form, {\n            layout: \"vertical\",\n            onFinish: this.onFinish,\n            children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n              name: \"siteName\",\n              label: \"\\u7AD9\\u70B9\",\n              rules: [{\n                required: true,\n                message: '请选择站点'\n              }],\n              children: /*#__PURE__*/_jsxDEV(Select, {\n                showSearch: true,\n                placeholder: \"\\u53EF\\u4EE5\\u641C\\u7D22\\u7AD9\\u70B9\",\n                filterOption: (input, option) => option.children.toLowerCase().indexOf(input.toLowerCase()) >= 0,\n                onSelect: this.handleSelect,\n                children: sites.map((item, _) => {\n                  return /*#__PURE__*/_jsxDEV(Option, {\n                    value: item.siteName,\n                    children: item.siteName\n                  }, item.id, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 174,\n                    columnNumber: 48\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 159,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n              name: \"useTime\",\n              label: \"\\u7528\\u65F6\",\n              rules: [{\n                required: true,\n                message: '请输入用时'\n              }],\n              children: /*#__PURE__*/_jsxDEV(Input, {\n                placeholder: \"\\u8BF7\\u8F93\\u5165\\u7528\\u65F6\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 184,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                textAlign: 'right',\n                marginTop: '50px'\n              },\n              children: /*#__PURE__*/_jsxDEV(Space, {\n                size: \"large\",\n                children: [/*#__PURE__*/_jsxDEV(Button, {\n                  onClick: this.handleCancel,\n                  style: {\n                    marginRight: 8\n                  },\n                  children: \"\\u53D6\\u6D88\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 193,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(Button, {\n                  type: \"primary\",\n                  htmlType: \"submit\",\n                  children: \"\\u786E\\u8BA4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 196,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 192,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 13\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["E:/React/workspace/order-ticket/src/pages/Dev/Trains/SiteInfo/index.jsx"],"names":["React","Component","Card","Button","Table","Modal","Space","Form","Select","Popconfirm","Divider","message","Input","PlusOutlined","LinkButton","getSiteList","Option","SiteInfo","state","showStatus","number","dataSource","sites","siteId","addUpdata","addSite","result","code","setState","data","error","msg","handleCancel","onFinish","values","v","key","newData","useTime","site","props","handleDelete","newDataSource","filter","item","deleteSite","length","count","handleSelect","_","value","componentDidMount","siteList","console","log","newList","map","timeConsume","render","columns","title","dataIndex","align","record","marginRight","handleAdd","top","required","input","option","children","toLowerCase","indexOf","siteName","id","textAlign","marginTop"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Card, Button, Table, Modal, Space, Form, Select, Popconfirm, Divider, message, Input } from 'antd'\r\nimport {\r\n    PlusOutlined\r\n} from '@ant-design/icons';\r\nimport LinkButton from '../../../../components/LinkButton';\r\nimport { getSiteList } from '../../../../api/dev/train';\r\n\r\n\r\nconst { Option } = Select\r\nexport default class SiteInfo extends Component {\r\n\r\n    state = {\r\n        showStatus: 0,\r\n        number: 1,\r\n        dataSource: [],\r\n        sites: [],\r\n        siteId: 0,\r\n        addUpdata: 0,\r\n    }\r\n\r\n    addSite = async () => {\r\n        // 调用接口拿数据\r\n        const result = await getSiteList()\r\n        if (result.code === 1) {\r\n            this.setState({ showStatus: 1, sites: result.data })\r\n        } else {\r\n            message.error(result.msg)\r\n        }\r\n\r\n    }\r\n\r\n    // 处理点击取消\r\n    handleCancel = () => {\r\n        this.setState({ showStatus: 0 })\r\n    }\r\n\r\n    // 表单提交\r\n    onFinish = (values) => {\r\n        const { dataSource, number, siteId } = this.state\r\n        const v = { number, ...values }\r\n        v.number = number\r\n        v.siteId = siteId\r\n        v.key = siteId\r\n        const newData = [...dataSource, v]\r\n        const { useTime } = values\r\n        const site = { siteId, useTime, number }\r\n        this.props.addSite(site)\r\n        this.setState({ showStatus: 0, dataSource: newData, number: number + 1 })\r\n    }\r\n\r\n    handleDelete = (number) => {\r\n        const dataSource = [...this.state.dataSource];\r\n        const newDataSource = dataSource.filter((item) => {\r\n            if (item.number !== number) {\r\n                if (item.number > number) {\r\n                    --item.number\r\n                }\r\n                return item\r\n            }\r\n        })\r\n        this.props.deleteSite(number)\r\n        if (newDataSource.length === 0) this.setState({ count: 1 })\r\n        this.setState({\r\n            dataSource: newDataSource,\r\n        });\r\n    }\r\n\r\n    // 处理选中站点\r\n    handleSelect = (_, value) => {\r\n        this.setState({ siteId: value.key })\r\n    }\r\n    componentDidMount() {\r\n        let { siteList } = this.props\r\n        console.log(!siteList)\r\n        let { number } = this.state\r\n        const newList = siteList.map((item, _) => {\r\n            item.number = number\r\n            number++\r\n            item.useTime = item.timeConsume\r\n            return item\r\n        })\r\n        this.setState({ dataSource: newList, number })\r\n    }\r\n    render() {\r\n\r\n        let { showStatus, dataSource, sites } = this.state\r\n\r\n        const columns = [\r\n            {\r\n                title: '序号',\r\n                dataIndex: 'number',\r\n                key: '1',\r\n                align: 'center',\r\n            },\r\n            {\r\n                title: '到达城市',\r\n                dataIndex: 'siteName',\r\n                key: '2',\r\n                align: 'center',\r\n            },\r\n            {\r\n                title: '用时（分）',\r\n                dataIndex: 'useTime',\r\n                key: '3',\r\n                align: 'center',\r\n            }\r\n            ,\r\n            {\r\n                title: '操作',\r\n                key: '4',\r\n                align: 'center',\r\n                render: (_, record) =>\r\n                    this.state.dataSource.length >= 1 ? (\r\n                        <div>\r\n                            <Popconfirm title=\"确定删除吗\" onConfirm={() => this.handleDelete(record.number)}>\r\n                                <LinkButton >删除</LinkButton>\r\n                            </Popconfirm>\r\n                        </div>\r\n                    ) : null,\r\n            }\r\n        ];\r\n\r\n        return (\r\n            <div>\r\n                <div>\r\n                    <Card\r\n                        title={<Divider orientation=\"left\" plain>\r\n                            <Button shape='round'>站点信息</Button>\r\n                        </Divider>}\r\n                        size='small'\r\n                        extra={<Button onClick={this.addSite} icon={<PlusOutlined />} type=\"primary\" style={{ marginRight: '20px' }}></Button>}\r\n                    >\r\n                        <Table\r\n                            columns={columns}\r\n                            dataSource={dataSource}\r\n                            bordered\r\n                            rowKey=\"number\"\r\n                            pagination={false}\r\n                        />\r\n                    </Card>\r\n                </div>\r\n                {/* 添加车厢信息的模态窗口 */}\r\n                <div>\r\n                    <Modal\r\n                        title=\"添加车厢信息\"\r\n                        visible={showStatus === 1}\r\n                        onOk={this.handleAdd}\r\n                        onCancel={this.handleCancel}\r\n                        footer={[]}\r\n                        width='800px'\r\n                        style={{ top: 100 }}\r\n                        destroyOnClose='true'\r\n                    >\r\n                        <Form\r\n                            layout=\"vertical\"\r\n                            onFinish={this.onFinish}\r\n                        >\r\n                            <Form.Item\r\n                                name=\"siteName\"\r\n                                label=\"站点\"\r\n                                rules={[{ required: true, message: '请选择站点' }]}\r\n\r\n                            >\r\n                                <Select\r\n                                    showSearch\r\n                                    placeholder=\"可以搜索站点\"\r\n                                    filterOption={(input, option) =>\r\n                                        option.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n                                    }\r\n                                    onSelect={this.handleSelect}\r\n                                >\r\n                                    {sites.map((item, _) => {\r\n                                        return <Option key={item.id} value={item.siteName}>{item.siteName}</Option>\r\n                                    })}\r\n                                </Select>\r\n                            </Form.Item>\r\n                            <Form.Item\r\n                                name=\"useTime\"\r\n                                label=\"用时\"\r\n                                rules={[{ required: true, message: '请输入用时' }]}\r\n\r\n                            >\r\n                                <Input placeholder=\"请输入用时\" />\r\n                            </Form.Item>\r\n                            <div\r\n                                style={{\r\n                                    textAlign: 'right',\r\n                                    marginTop: '50px'\r\n                                }}\r\n                            >\r\n                                <Space size=\"large\">\r\n                                    <Button onClick={this.handleCancel} style={{ marginRight: 8 }}>\r\n                                        取消\r\n                                    </Button>\r\n                                    <Button type=\"primary\" htmlType=\"submit\">\r\n                                        确认\r\n                                    </Button>\r\n                                </Space>\r\n\r\n                            </div>\r\n                        </Form>\r\n                    </Modal>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}